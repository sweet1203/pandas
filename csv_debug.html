<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CSV ë””ë²„ê·¸</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f5f5f5;
    }
    .container {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .file-upload {
      border: 2px dashed #007bff;
      padding: 40px;
      text-align: center;
      margin: 20px 0;
      cursor: pointer;
      border-radius: 10px;
      background-color: #f8f9fa;
    }
    .file-upload:hover {
      border-color: #0056b3;
      background-color: #e9ecef;
    }
    .log {
      margin-top: 20px;
      padding: 15px;
      background-color: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 5px;
      font-family: monospace;
      font-size: 12px;
      max-height: 300px;
      overflow-y: auto;
    }
    .error {
      background-color: #f8d7da;
      color: #721c24;
      padding: 10px;
      border-radius: 5px;
      margin: 10px 0;
    }
    .success {
      background-color: #d4edda;
      color: #155724;
      padding: 10px;
      border-radius: 5px;
      margin: 10px 0;
    }
    .info {
      background-color: #d1ecf1;
      color: #0c5460;
      padding: 10px;
      border-radius: 5px;
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ› CSV ë””ë²„ê·¸ ë„êµ¬</h1>
    <p>íŒŒì¼ ì—…ë¡œë“œ ê³¼ì •ì„ ë‹¨ê³„ë³„ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    
    <div class="file-upload" id="fileUpload">
      <h3>ğŸ“ CSV íŒŒì¼ ì—…ë¡œë“œ</h3>
      <p>í´ë¦­í•˜ê±°ë‚˜ ë“œë˜ê·¸í•˜ì—¬ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”</p>
      <input type="file" id="csvFile" accept=".csv" style="display: none;">
    </div>
    
    <div id="log" class="log">
      <div class="info">ë¡œê·¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
  <script>
    // ë¡œê·¸ í•¨ìˆ˜
    function addLog(message, type = 'info') {
      const logDiv = document.getElementById('log');
      const timestamp = new Date().toLocaleTimeString();
      const logEntry = document.createElement('div');
      logEntry.className = type;
      logEntry.innerHTML = `[${timestamp}] ${message}`;
      logDiv.appendChild(logEntry);
      logDiv.scrollTop = logDiv.scrollHeight;
      console.log(`[${timestamp}] ${message}`);
    }
    
    // í˜ì´ì§€ ë¡œë“œ ì‹œ
    addLog('í˜ì´ì§€ ë¡œë“œë¨', 'success');
    
    // DOM ìš”ì†Œ í™•ì¸
    function checkElements() {
      const fileUpload = document.getElementById('fileUpload');
      const csvFile = document.getElementById('csvFile');
      
      if (fileUpload) {
        addLog('âœ… fileUpload ìš”ì†Œ ì°¾ìŒ', 'success');
      } else {
        addLog('âŒ fileUpload ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ', 'error');
      }
      
      if (csvFile) {
        addLog('âœ… csvFile ìš”ì†Œ ì°¾ìŒ', 'success');
      } else {
        addLog('âŒ csvFile ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ', 'error');
      }
    }
    
    // íŒŒì¼ ì—…ë¡œë“œ í´ë¦­ ì´ë²¤íŠ¸
    document.getElementById('fileUpload').addEventListener('click', function() {
      addLog('ğŸ“ íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ í´ë¦­ë¨', 'info');
      document.getElementById('csvFile').click();
    });
    
    // íŒŒì¼ ì„ íƒ ì´ë²¤íŠ¸
    document.getElementById('csvFile').addEventListener('change', function(e) {
      addLog('ğŸ“‚ íŒŒì¼ ì„ íƒ ì´ë²¤íŠ¸ ë°œìƒ', 'info');
      const file = e.target.files[0];
      if (file) {
        addLog(`ğŸ“„ íŒŒì¼ ì •ë³´: ${file.name} (${file.size} bytes, ${file.type})`, 'info');
        processFile(file);
      } else {
        addLog('âŒ íŒŒì¼ì´ ì„ íƒë˜ì§€ ì•ŠìŒ', 'error');
      }
    });
    
    // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì´ë²¤íŠ¸
    const fileUpload = document.getElementById('fileUpload');
    
    fileUpload.addEventListener('dragover', function(e) {
      e.preventDefault();
      addLog('ğŸ”„ ë“œë˜ê·¸ ì˜¤ë²„ ì´ë²¤íŠ¸', 'info');
      fileUpload.style.borderColor = '#28a745';
      fileUpload.style.backgroundColor = '#d4edda';
    });
    
    fileUpload.addEventListener('dragleave', function(e) {
      e.preventDefault();
      addLog('ğŸ‘‹ ë“œë˜ê·¸ ë¦¬ë¸Œ ì´ë²¤íŠ¸', 'info');
      fileUpload.style.borderColor = '#007bff';
      fileUpload.style.backgroundColor = '#f8f9fa';
    });
    
    fileUpload.addEventListener('drop', function(e) {
      e.preventDefault();
      addLog('ğŸ“¥ ë“œë¡­ ì´ë²¤íŠ¸ ë°œìƒ', 'info');
      fileUpload.style.borderColor = '#007bff';
      fileUpload.style.backgroundColor = '#f8f9fa';
      
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        const file = files[0];
        addLog(`ğŸ“„ ë“œë¡­ëœ íŒŒì¼: ${file.name} (${file.size} bytes, ${file.type})`, 'info');
        processFile(file);
      } else {
        addLog('âŒ ë“œë¡­ëœ íŒŒì¼ì´ ì—†ìŒ', 'error');
      }
    });
    
    // íŒŒì¼ ì²˜ë¦¬ í•¨ìˆ˜
    function processFile(file) {
      addLog('ğŸ”„ íŒŒì¼ ì²˜ë¦¬ ì‹œì‘', 'info');
      
      // íŒŒì¼ í¬ê¸° ì²´í¬
      if (file.size > 10 * 1024 * 1024) { // 10MB ì œí•œ
        addLog('âŒ íŒŒì¼ì´ ë„ˆë¬´ í¼ (10MB ì´ˆê³¼)', 'error');
        return;
      }
      
      // íŒŒì¼ íƒ€ì… ì²´í¬
      const isCSV = file.type === 'text/csv' || 
                   file.name.toLowerCase().endsWith('.csv') ||
                   file.type === 'application/vnd.ms-excel' ||
                   file.type === 'application/csv';
      
      if (!isCSV) {
        addLog(`âŒ CSV íŒŒì¼ì´ ì•„ë‹˜: ${file.type}`, 'error');
        return;
      }
      
      addLog('âœ… íŒŒì¼ ê²€ì¦ í†µê³¼', 'success');
      
      // íŒŒì¼ ì½ê¸°
      const reader = new FileReader();
      
      reader.onload = function(e) {
        addLog('ğŸ“– íŒŒì¼ ì½ê¸° ì™„ë£Œ', 'success');
        const content = e.target.result;
        addLog(`ğŸ“Š íŒŒì¼ ë‚´ìš© ê¸¸ì´: ${content.length} ë¬¸ì`, 'info');
        addLog(`ğŸ“‹ íŒŒì¼ ë‚´ìš© ë¯¸ë¦¬ë³´ê¸°: ${content.substring(0, 100)}...`, 'info');
        
        // Papa Parseë¡œ íŒŒì‹±
        Papa.parse(content, {
          complete: function(results) {
            addLog('âœ… íŒŒì‹± ì™„ë£Œ', 'success');
            addLog(`ğŸ“Š ì´ í–‰ ìˆ˜: ${results.data.length}`, 'info');
            
            if (results.errors.length > 0) {
              addLog(`âŒ íŒŒì‹± ì˜¤ë¥˜: ${results.errors.length}ê°œ`, 'error');
              results.errors.forEach((error, index) => {
                addLog(`   ì˜¤ë¥˜ ${index + 1}: ${error.message}`, 'error');
              });
            }
            
            if (results.data.length > 0) {
              addLog(`ğŸ“‹ í—¤ë”: ${results.data[0].join(', ')}`, 'info');
              addLog(`ğŸ“Š ì²« ë²ˆì§¸ ë°ì´í„° í–‰: ${results.data[1] ? results.data[1].join(', ') : 'ì—†ìŒ'}`, 'info');
            }
          },
          error: function(error) {
            addLog(`âŒ Papa Parse ì˜¤ë¥˜: ${error.message}`, 'error');
          }
        });
      };
      
      reader.onerror = function() {
        addLog('âŒ íŒŒì¼ ì½ê¸° ì˜¤ë¥˜', 'error');
      };
      
      reader.readAsText(file, 'UTF-8');
    }
    
    // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ ìš”ì†Œ í™•ì¸
    window.addEventListener('load', function() {
      addLog('ğŸŒ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ', 'success');
      checkElements();
    });
    
    // DOMContentLoaded ì´ë²¤íŠ¸
    document.addEventListener('DOMContentLoaded', function() {
      addLog('ğŸ“„ DOM ë¡œë“œ ì™„ë£Œ', 'success');
    });
  </script>
</body>
</html> 